{"remainingRequest":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/src/views/ShellGlobalModule/ShellGlobalCode/ShellGlobal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/src/views/ShellGlobalModule/ShellGlobalCode/ShellGlobal.vue","mtime":1554705128309},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport vTable from \"@c/tables/table\";\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\nimport vEditTable from \"@c/edit_table\";\nimport vButtons from \"@c/buttons\";\n\nimport AreaApi from \"../../DictModule/webapi/AreaApi\";\nimport DataApi from \"../../DictModule/webapi/DataApi\";\nimport MatlApi from \"../../MatlModule/webapi/MaterialsApi\";\nimport ShellApi from \"../webapi/ShellGlobal\";\nimport moment from \"moment\";\nimport config from \"@/config/index\";\nimport { pageTool } from \"@/js/util.js\";\nvar TerminalType = {\n  \"1\": \"总控\",\n  \"2\": \"分控\",\n  \"3\": \"HubApp\",\n  \"4\": \"CCN\"\n};\nvar TableUniqueId = \"AppId\";\n\nexport default {\n  data() {\n    var _ = this;\n    return {\n      isEdit: false,\n      formData: {\n        No: \"\", //编号\n        Name: \"\", //名称\n        Code: \"\", //编码\n        MnenonicCode: \"\" //助记码\n      },\n      // 选择所需的功能按钮\n      // seleFunc: { add: true, export: true, search: true },\n      // 选择所需的功能按钮\n      // seleFunc: { add: true, export: true, search: true },\n      // 动态创建所需的功能按钮，添加 和 导出 功能已封装完善，默认显示\n      seleFunc: {\n        export: false,\n        search: true\n      \n      },\n      buttonOptions: [\n        // {\n        //   title: \"下载\",\n        //   method: function(e, item) {\n        //     console.log(\"下载被点击\");\n        //     debugger;\n        //     let seleCheckBoxs = _.$refs.table.tableObj.bootstrapTable(\n        //       \"getSelections\"\n        //     );\n        //   }\n        // },\n        {\n          title: \"添加\",\n          iconStr: \"fa-plus\",\n          method: function() {\n            _.showAddRecordModal();\n          }\n        }\n      ],\n      //   \"OrganiztionSN\": \"CNN100364\",\n      // \"AppKey\": \" 6640a392dfbd9c0a\",\n      // \"AppSecret\": \"68bac75ed032e0a86bc3eae1b5c996cf\",\n      // \"TerminalType\": 1,\n      // \"IsDelete\": \"1\",\n      search_controls: [\n        {\n          type: \"v_singleSelect\",\n          title: \"部署点\",\n          key: \"OrganiztionSN\",\n          apiUrl: ShellApi.GetOrganiztionList,\n          //params: { aaa: \"fff\" },\n          selectkey: \"OrganiztionId\",\n          selectvalue: \"OrganiztionSN\"\n        },\n        {\n          type: \"v_singleSelect\",\n          title: \"状态\",\n          key: \"IsDelete\",\n          data: [\n            {\n              typeid: \"0\",\n              typename: \"启用\"\n            },\n            {\n              typeid: \"1\",\n              typename: \"禁用\"\n            }\n          ],\n          selectkey: \"typeid\",\n          selectvalue: \"typename\"\n        },\n        {\n          type: \"v_singleSelect\",\n          title: \"设备类型\",\n          key: \"TerminalType\",\n          data: [\n            {\n              id: \"1\",\n              value: \"总控\"\n            },\n            {\n              id: \"2\",\n              value: \"分控\"\n            },\n            {\n              id: \"3\",\n              value: \"HubApp\"\n            },\n            {\n              id: \"4\",\n              value: \"CCN\"\n            }\n          ],\n          selectkey: \"id\",\n          selectvalue: \"value\"\n        }\n      ],\n      // vEditTable 组件数据\n      dynamicEdits: {\n        apiUrl: ShellApi.UpdateDeleteStatus,\n        paras: {},\n        list: [\n          {\n            lineType: \"single\",\n            rowList: [\n              {\n                type: \"v_text\",\n                title: \"AppKey\",\n                key: \"AppKey\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"AppKey不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_text\",\n                title: \"AppSecret\",\n                key: \"AppSecret\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"AppSecret不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_singleSelect\",\n                title: \"设备类型\",\n                key: \"TerminalType\",\n                data: [\n                  {\n                    TerminalType: \"1\",\n                    value: \"总控\"\n                  },\n                  {\n                    TerminalType: \"2\",\n                    value: \"分控\"\n                  },\n                  {\n                    TerminalType: \"3\",\n                    value: \"HubApp\"\n                  },\n                  {\n                    TerminalType: \"4\",\n                    value: \"CCN\"\n                  }\n                ],\n                selectkey: \"TerminalType\",\n                selectvalue: \"value\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"设备类型不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_singleSelect\",\n                title: \"部署点\",\n                key: \"OrganiztionSN\",\n                apiUrl: ShellApi.GetOrganiztionList,\n                //params: { aaa: \"fff\" },\n                selectkey: \"OrganiztionId\",\n                selectvalue: \"OrganiztionSN\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"部署点不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_text\",\n                title: \"备注\",\n                key: \"Remark\",\n                isRequest: false,\n                validators: {\n                  notEmpty: {\n                    enabled: false\n                  }\n                }\n              }\n            ]\n          }\n        ]\n      },\n      seleTableObj: {}, // 选中的表单行数据\n\n      searchOptions: {\n        requiredCondition: true\n      },\n      tableOption: {\n        tableId: \"sendreport\",\n        tableName: \"发货统计报表\",\n        url: config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url,\n        method: ShellApi.GetAppInfoList.options.method,\n        uniqueId: TableUniqueId,\n        // actions: [\n        //   {\n        //     key: \"tableEdit\",\n        //     title: \"编辑\"\n        //   },\n        //   {\n        //     key: \"tablePause\",\n        //     title: \"启用/禁用\",\n        //     buttonType: 'btn-danger'\n        //   },\n        //   {\n        //     key: \"tableDownload\",\n        //     title: \"下载\"\n        //   }\n        // ],\n        columns: [\n          {\n            field: \"OrganiztionSN\",\n            title: \"部署点编号\",\n            align: \"left\",\n            width: \"150px\",\n            cellStyle: function(value, row, index) {\n              // 设置超过行宽以省略号显示\n              return {\n                css: {\n                  overflow: \"hidden\",\n                  \"text-overflow\": \"ellipsis\",\n                  \"white-space\": \"nowrap\",\n                  display: \"inline-block\"\n                }\n              };\n            }\n          },\n          { field: \"AppKey\", title: \"AppKey\", align: \"center\" },\n          { field: \"AppSecret\", title: \"AppSecret\", align: \"center\" },\n          {\n            field: \"TerminalType\",\n            title: \"设备类型\",\n            align: \"center\",\n            formatter: function(val, row) {\n              return TerminalType[row.TerminalType];\n            }\n          },\n          {\n            field: \"IsDelete\",\n            title: \"状态\",\n            align: \"center\",\n            formatter: function(val, row) {\n              return row.IsDelete == 1 ? \"禁用\" : \"启用\";\n            }\n          },\n          {\n            field: \"action\",\n            title: \"操作\",\n            align: \"\",\n            formatter: function(val, row) {\n              \n              let rowId = row[TableUniqueId];\n              let btnType = {};\n              if (row[\"IsDelete\"] == 1) {\n                 btnType.className = \"btn btn-danger\";\n                 btnType.title = \"禁用\";\n              } else {\n                btnType.className = \"btn btn-success\";\n                btnType.title = \"启用\";\n              }\n              let pauseStr = \"<button id=\" +\n                \"tablePause\" +\n                \" type=button class=\" +\n                '\"' +\n                btnType.className +\n                '\"' +\n                \" +  rowId=\" +\n                rowId +\n                \">\" +\n                btnType.title +\n                \"</button>&nbsp;\";\n                return \"<button id='tableEdit' type='button' class='btn btn-primary' rowId=\" + rowId + '>编辑</button>&nbsp;' + pauseStr + \"<button id='tableDownload' type='button' class='btn btn-primary' rowId=\" + rowId + '>下载</button>';\n\n            }\n          }\n\n        ]\n      }\n    };\n  },\n  computed: {\n    exportOptions: function() {\n      return {\n        id: this.tableOption.tableId,\n        name: this.tableOption.tableName,\n        url: ShellApi.TableDataList\n      };\n    }\n  },\n  mounted: function() {},\n  methods: {\n    // 表格回调事件名规则   传入的按钮 key + Block\n    // 编辑按钮点击事件\n    tableEditBlock: function(rowItem) {\n      let _ = this;\n      ShellApi.GetAppInfoById({\n        AppId: rowItem[TableUniqueId]\n      }).then(res => {\n        debugger;\n        _.seleTableObj = res.result;\n        _.showAddRecordModal();\n      });\n    },\n\n    // 禁用按钮点击事件\n    tablePauseBlock: function(rowItem,btn) {\n      let _ = this;\n      ShellApi.UpdateDeleteStatus({\n        AppId: rowItem[TableUniqueId]\n      }).then(res => {\n        debugger;\n        $(btn).removeClass('btn-danger').addClass('btn-success');\n        _.$refs.table.operation(\"refresh\");\n      });\n    },\n    // 下载按钮点击事件\n    tableDownloadBlock: function(rowItem) {\n      let _ = this;\n      debugger;\n      ShellApi.GetAppXMLDownLoadUrl({ AppId: rowItem[TableUniqueId] }).then(res => {\n        if (res.success) {\n          debugger;\n          console.log(res);\n          location.href = res.result;\n        }\n      });\n    },\n    tableDetailBlock: function() {\n      \n    },\n    // 动态搜索回调\n    search: function(params) {\n      console.log(params);\n      // AppKey\n      // AppSecret\n      // TerminalType  1-总控机；2-分控机；3-HubApp；4-CCN；\n      // IsDelete  是否删除： 0表示是，1表示否\n      this.refreshTable(params);\n    },\n    // 新建 & 编辑表单记录完成后的回调事件\n    editCallback: function(type, params) {\n      // type = add   type = edit\n      // this.refreshTable(params);\n      this.$refs.table.operation(\"refresh\");\n    },\n    deleReportData: function(reportId) {\n      let _ = this;\n      ShellApi.DeleteTableRecord({\n        reportId: reportId\n      }).then(res => {\n        console.log(res);\n        if (res.success) {\n          _.$refs.table.tableObj.bootstrapTable(\"removeByUniqueId\", reportId);\n          layer.msg(\"删除成功\");\n        }\n      });\n    },\n    // 刷新表单\n    refreshTable: function(params) {\n      this.$refs.table.tableOption.url =\n        config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url;\n      this.$refs.table.tableOption.params = params;\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 显示新建 & 编辑表单记录弹框\n    showAddRecordModal: function() {\n      let _ = this;\n      _.isEdit = true;\n      _.$nextTick(() => {\n        _.layerId = layer.open({\n          type: 1,\n          title: \"添加报告记录\",\n          maxmin: false,\n          area: [\"70%\", \"70%\"],\n          content: $(\"#pop\"),\n          end: function() {\n            _.isEdit = false;\n            _.seleTableObj = {};\n          }\n        });\n      });\n    }\n  },\n\n  components: { vTable, vSearch, vEditTable, vButtons }\n};\n",{"version":3,"sources":["ShellGlobal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"ShellGlobal.vue","sourceRoot":"src/views/ShellGlobalModule/ShellGlobalCode","sourcesContent":["<template>\n  <div>\n    <div class=\"box box-default\">\n      <div class=\"box-body box-body-resizer\">\n        <form class=\"form-inline\" id=\"search-query\" style=\"display: inline-block;\n    width: 100%;\">\n          <div class=\"search-bar\" style=\"float:left;width:99%;position: relative;\">\n            <vSearch\n              v-bind:dynamicControls=\"search_controls\"\n              v-bind:exportOptions=\"exportOptions\"\n              v-bind:searchOptions=\"searchOptions\"\n              v-bind:seleFunc=\"seleFunc\"\n              @callback=\"search\"\n              style=\"float:left\"\n            ></vSearch>\n            <br>\n          </div>\n        </form>\n\n        <div style=\"position: relative;height: 60px;\">\n          <vButtons :buttonOptions=\"buttonOptions\"></vButtons>\n        </div>\n        <vEditTable\n          v-if=\"isEdit\"\n          id=\"pop\"\n          :dynamicEdits=\"dynamicEdits\"\n          :seleTableObj=\"seleTableObj\"\n          @editCallback=\"editCallback\"\n        ></vEditTable>\n\n        <vTable\n          ref=\"table\"\n          :option=\"tableOption\"\n          @tableEditBlock=\"tableEditBlock\"\n          @tablePauseBlock=\"tablePauseBlock\"\n          @tableDownloadBlock=\"tableDownloadBlock\"\n          @tableDetailBlock=\"tableDetailBlock\"\n        ></vTable>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport vTable from \"@c/tables/table\";\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\nimport vEditTable from \"@c/edit_table\";\nimport vButtons from \"@c/buttons\";\n\nimport AreaApi from \"../../DictModule/webapi/AreaApi\";\nimport DataApi from \"../../DictModule/webapi/DataApi\";\nimport MatlApi from \"../../MatlModule/webapi/MaterialsApi\";\nimport ShellApi from \"../webapi/ShellGlobal\";\nimport moment from \"moment\";\nimport config from \"@/config/index\";\nimport { pageTool } from \"@/js/util.js\";\nvar TerminalType = {\n  \"1\": \"总控\",\n  \"2\": \"分控\",\n  \"3\": \"HubApp\",\n  \"4\": \"CCN\"\n};\nvar TableUniqueId = \"AppId\";\n\nexport default {\n  data() {\n    var _ = this;\n    return {\n      isEdit: false,\n      formData: {\n        No: \"\", //编号\n        Name: \"\", //名称\n        Code: \"\", //编码\n        MnenonicCode: \"\" //助记码\n      },\n      // 选择所需的功能按钮\n      // seleFunc: { add: true, export: true, search: true },\n      // 选择所需的功能按钮\n      // seleFunc: { add: true, export: true, search: true },\n      // 动态创建所需的功能按钮，添加 和 导出 功能已封装完善，默认显示\n      seleFunc: {\n        export: false,\n        search: true\n      \n      },\n      buttonOptions: [\n        // {\n        //   title: \"下载\",\n        //   method: function(e, item) {\n        //     console.log(\"下载被点击\");\n        //     debugger;\n        //     let seleCheckBoxs = _.$refs.table.tableObj.bootstrapTable(\n        //       \"getSelections\"\n        //     );\n        //   }\n        // },\n        {\n          title: \"添加\",\n          iconStr: \"fa-plus\",\n          method: function() {\n            _.showAddRecordModal();\n          }\n        }\n      ],\n      //   \"OrganiztionSN\": \"CNN100364\",\n      // \"AppKey\": \" 6640a392dfbd9c0a\",\n      // \"AppSecret\": \"68bac75ed032e0a86bc3eae1b5c996cf\",\n      // \"TerminalType\": 1,\n      // \"IsDelete\": \"1\",\n      search_controls: [\n        {\n          type: \"v_singleSelect\",\n          title: \"部署点\",\n          key: \"OrganiztionSN\",\n          apiUrl: ShellApi.GetOrganiztionList,\n          //params: { aaa: \"fff\" },\n          selectkey: \"OrganiztionId\",\n          selectvalue: \"OrganiztionSN\"\n        },\n        {\n          type: \"v_singleSelect\",\n          title: \"状态\",\n          key: \"IsDelete\",\n          data: [\n            {\n              typeid: \"0\",\n              typename: \"启用\"\n            },\n            {\n              typeid: \"1\",\n              typename: \"禁用\"\n            }\n          ],\n          selectkey: \"typeid\",\n          selectvalue: \"typename\"\n        },\n        {\n          type: \"v_singleSelect\",\n          title: \"设备类型\",\n          key: \"TerminalType\",\n          data: [\n            {\n              id: \"1\",\n              value: \"总控\"\n            },\n            {\n              id: \"2\",\n              value: \"分控\"\n            },\n            {\n              id: \"3\",\n              value: \"HubApp\"\n            },\n            {\n              id: \"4\",\n              value: \"CCN\"\n            }\n          ],\n          selectkey: \"id\",\n          selectvalue: \"value\"\n        }\n      ],\n      // vEditTable 组件数据\n      dynamicEdits: {\n        apiUrl: ShellApi.UpdateDeleteStatus,\n        paras: {},\n        list: [\n          {\n            lineType: \"single\",\n            rowList: [\n              {\n                type: \"v_text\",\n                title: \"AppKey\",\n                key: \"AppKey\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"AppKey不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_text\",\n                title: \"AppSecret\",\n                key: \"AppSecret\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"AppSecret不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_singleSelect\",\n                title: \"设备类型\",\n                key: \"TerminalType\",\n                data: [\n                  {\n                    TerminalType: \"1\",\n                    value: \"总控\"\n                  },\n                  {\n                    TerminalType: \"2\",\n                    value: \"分控\"\n                  },\n                  {\n                    TerminalType: \"3\",\n                    value: \"HubApp\"\n                  },\n                  {\n                    TerminalType: \"4\",\n                    value: \"CCN\"\n                  }\n                ],\n                selectkey: \"TerminalType\",\n                selectvalue: \"value\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"设备类型不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_singleSelect\",\n                title: \"部署点\",\n                key: \"OrganiztionSN\",\n                apiUrl: ShellApi.GetOrganiztionList,\n                //params: { aaa: \"fff\" },\n                selectkey: \"OrganiztionId\",\n                selectvalue: \"OrganiztionSN\",\n                isRequest: true,\n                validators: {\n                  notEmpty: {\n                    enabled: true,\n                    message: \"部署点不能为空\"\n                  }\n                }\n              },\n              {\n                type: \"v_text\",\n                title: \"备注\",\n                key: \"Remark\",\n                isRequest: false,\n                validators: {\n                  notEmpty: {\n                    enabled: false\n                  }\n                }\n              }\n            ]\n          }\n        ]\n      },\n      seleTableObj: {}, // 选中的表单行数据\n\n      searchOptions: {\n        requiredCondition: true\n      },\n      tableOption: {\n        tableId: \"sendreport\",\n        tableName: \"发货统计报表\",\n        url: config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url,\n        method: ShellApi.GetAppInfoList.options.method,\n        uniqueId: TableUniqueId,\n        // actions: [\n        //   {\n        //     key: \"tableEdit\",\n        //     title: \"编辑\"\n        //   },\n        //   {\n        //     key: \"tablePause\",\n        //     title: \"启用/禁用\",\n        //     buttonType: 'btn-danger'\n        //   },\n        //   {\n        //     key: \"tableDownload\",\n        //     title: \"下载\"\n        //   }\n        // ],\n        columns: [\n          {\n            field: \"OrganiztionSN\",\n            title: \"部署点编号\",\n            align: \"left\",\n            width: \"150px\",\n            cellStyle: function(value, row, index) {\n              // 设置超过行宽以省略号显示\n              return {\n                css: {\n                  overflow: \"hidden\",\n                  \"text-overflow\": \"ellipsis\",\n                  \"white-space\": \"nowrap\",\n                  display: \"inline-block\"\n                }\n              };\n            }\n          },\n          { field: \"AppKey\", title: \"AppKey\", align: \"center\" },\n          { field: \"AppSecret\", title: \"AppSecret\", align: \"center\" },\n          {\n            field: \"TerminalType\",\n            title: \"设备类型\",\n            align: \"center\",\n            formatter: function(val, row) {\n              return TerminalType[row.TerminalType];\n            }\n          },\n          {\n            field: \"IsDelete\",\n            title: \"状态\",\n            align: \"center\",\n            formatter: function(val, row) {\n              return row.IsDelete == 1 ? \"禁用\" : \"启用\";\n            }\n          },\n          {\n            field: \"action\",\n            title: \"操作\",\n            align: \"\",\n            formatter: function(val, row) {\n              \n              let rowId = row[TableUniqueId];\n              let btnType = {};\n              if (row[\"IsDelete\"] == 1) {\n                 btnType.className = \"btn btn-danger\";\n                 btnType.title = \"禁用\";\n              } else {\n                btnType.className = \"btn btn-success\";\n                btnType.title = \"启用\";\n              }\n              let pauseStr = \"<button id=\" +\n                \"tablePause\" +\n                \" type=button class=\" +\n                '\"' +\n                btnType.className +\n                '\"' +\n                \" +  rowId=\" +\n                rowId +\n                \">\" +\n                btnType.title +\n                \"</button>&nbsp;\";\n                return \"<button id='tableEdit' type='button' class='btn btn-primary' rowId=\" + rowId + '>编辑</button>&nbsp;' + pauseStr + \"<button id='tableDownload' type='button' class='btn btn-primary' rowId=\" + rowId + '>下载</button>';\n\n            }\n          }\n\n        ]\n      }\n    };\n  },\n  computed: {\n    exportOptions: function() {\n      return {\n        id: this.tableOption.tableId,\n        name: this.tableOption.tableName,\n        url: ShellApi.TableDataList\n      };\n    }\n  },\n  mounted: function() {},\n  methods: {\n    // 表格回调事件名规则   传入的按钮 key + Block\n    // 编辑按钮点击事件\n    tableEditBlock: function(rowItem) {\n      let _ = this;\n      ShellApi.GetAppInfoById({\n        AppId: rowItem[TableUniqueId]\n      }).then(res => {\n        debugger;\n        _.seleTableObj = res.result;\n        _.showAddRecordModal();\n      });\n    },\n\n    // 禁用按钮点击事件\n    tablePauseBlock: function(rowItem,btn) {\n      let _ = this;\n      ShellApi.UpdateDeleteStatus({\n        AppId: rowItem[TableUniqueId]\n      }).then(res => {\n        debugger;\n        $(btn).removeClass('btn-danger').addClass('btn-success');\n        _.$refs.table.operation(\"refresh\");\n      });\n    },\n    // 下载按钮点击事件\n    tableDownloadBlock: function(rowItem) {\n      let _ = this;\n      debugger;\n      ShellApi.GetAppXMLDownLoadUrl({ AppId: rowItem[TableUniqueId] }).then(res => {\n        if (res.success) {\n          debugger;\n          console.log(res);\n          location.href = res.result;\n        }\n      });\n    },\n    tableDetailBlock: function() {\n      \n    },\n    // 动态搜索回调\n    search: function(params) {\n      console.log(params);\n      // AppKey\n      // AppSecret\n      // TerminalType  1-总控机；2-分控机；3-HubApp；4-CCN；\n      // IsDelete  是否删除： 0表示是，1表示否\n      this.refreshTable(params);\n    },\n    // 新建 & 编辑表单记录完成后的回调事件\n    editCallback: function(type, params) {\n      // type = add   type = edit\n      // this.refreshTable(params);\n      this.$refs.table.operation(\"refresh\");\n    },\n    deleReportData: function(reportId) {\n      let _ = this;\n      ShellApi.DeleteTableRecord({\n        reportId: reportId\n      }).then(res => {\n        console.log(res);\n        if (res.success) {\n          _.$refs.table.tableObj.bootstrapTable(\"removeByUniqueId\", reportId);\n          layer.msg(\"删除成功\");\n        }\n      });\n    },\n    // 刷新表单\n    refreshTable: function(params) {\n      this.$refs.table.tableOption.url =\n        config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url;\n      this.$refs.table.tableOption.params = params;\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 显示新建 & 编辑表单记录弹框\n    showAddRecordModal: function() {\n      let _ = this;\n      _.isEdit = true;\n      _.$nextTick(() => {\n        _.layerId = layer.open({\n          type: 1,\n          title: \"添加报告记录\",\n          maxmin: false,\n          area: [\"70%\", \"70%\"],\n          content: $(\"#pop\"),\n          end: function() {\n            _.isEdit = false;\n            _.seleTableObj = {};\n          }\n        });\n      });\n    }\n  },\n\n  components: { vTable, vSearch, vEditTable, vButtons }\n};\n</script>\n<style>\n.datetimepicker {\n  z-index: 21212121 !important;\n}\n</style>\n\n"]}]}