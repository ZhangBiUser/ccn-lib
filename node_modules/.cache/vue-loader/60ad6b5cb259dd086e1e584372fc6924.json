{"remainingRequest":"/Users/hq_failmy/Desktop/文件上传管理，出参全小写/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hq_failmy/Desktop/文件上传管理，出参全小写/src/views/BasePage/BasePage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hq_failmy/Desktop/文件上传管理，出参全小写/src/views/BasePage/BasePage.vue","mtime":1555322729925},{"path":"/Users/hq_failmy/Desktop/文件上传管理，出参全小写/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/文件上传管理，出参全小写/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/文件上传管理，出参全小写/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport vTable from \"@c/tables/table\";\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\nimport vEditTable from \"@c/edit_table\";\nimport vButtons from \"@c/buttons\";\n\nimport moment from \"moment\";\nimport config from \"@/config/index\";\nimport { pageTool } from \"@/js/util.js\";\n\nexport default {\n  data() {\n    var _ = this;\n    return {\n      isEdit: false,\n      seleTableObj: {} // 选中的表单行数据\n    };\n  },\n  // props: [\"searchOptions\", \"buttonOptions\", \"editOptions\", \"tableOption\"],\n  props: {\n    searchOptions: {\n      type: Object,\n      default: () => {}\n    },\n    buttonOptions: {\n      type: Array,\n      default: () => []\n    },\n    editOptions: {\n      type: Object,\n      default: () => {}\n    },\n    tableOption: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  beforeMount() {\n    let _ = this;\n    !$.isEmptyObject(this.buttonOptions) &&\n      this.buttonOptions.map(item => {\n        if (item.key == \"add\") {\n          item.method = function() {\n            _.showAddRecordModal();\n          };\n        }\n      });\n    this.handleText();\n  },\n\n  computed: {\n    exportOptions: function() {\n      return {\n        id: this.tableOption.tableId,\n        name: this.tableOption.tableName,\n        url: this.searchOptions.exportUrl\n      };\n    }\n  },\n  mounted: function() {},\n  methods: {\n    // 如果给列设置宽度，超出部分文字隐藏显示\n    handleText: function() {\n      this.tableOption.columns.map(item => {\n        if (\"width\" in item) {\n          item.cellStyle = function(value, row, index) {\n            // 设置超过行宽以省略号显示\n            return {\n              css: {\n                overflow: \"hidden\",\n                \"text-overflow\": \"ellipsis\",\n                \"white-space\": \"nowrap\",\n                display: \"inline-block\"\n              }\n            };\n          };\n          item.formatter = function(value, row, index) {\n            var span = document.createElement(\"span\");\n            span.setAttribute(\"title\", value);\n            span.innerHTML = value;\n            return span.outerHTML;\n          };\n        }\n      });\n    },\n    rowClick: function(rowItem, element) {\n      let _ = this;\n      // debugger;\n      let currentAction = _.searchUrl(element);\n      if (!currentAction.url) {\n        _.$emit(\"rowBlock\", rowItem, element, _);\n        return;\n      }\n\n      let param = {};\n      param[_.tableOption.uniqueId] = rowItem[_.tableOption.uniqueId];\n      $.extend(param, currentAction.params);\n\n      currentAction.url(param).then(res => {\n        // debugger;\n        switch (element.id) {\n          case \"tableEdit\":\n            {\n              _.seleTableObj = res.result;\n              _.showAddRecordModal();\n            }\n            break;\n          // case \"tablePause\":\n          //   {\n          //     _.$refs.table.operation(\"refresh\");\n          //   }\n          //   break;\n          case \"tableDownload\":\n            {\n              // location.href = res.result.uploadUrl;\n              // window.open(res.result.uploadUrl);\n              var html = '<a id=\"download-file\" href=\"data:text/xml;charset=utf-8,' + encodeURIComponent(res.result.uploadUrl) + '\" download=\"99\">下载</a>';\n              // var html = '<a id=\"download-file\" href=' + res.result.uploadUrl + ' download=\"5cd1e027d74f49a88c70a23a5e7b1550.Xml\">下载</a>';\n              $(\"#downloaddiv\").html(html);\n              $('#download-file')[0].click();\n\n            }\n            break;\n          default:\n            {\n              _.$emit(\"rowBlock\", rowItem, element, _);\n            }\n            break;\n        }\n      });\n    },\n    componentMountBefore: function(element) {\n      this.$emit('componentMountBefore',element,this);\n    },\n    componentMountAfter: function(element) {\n      // debugger;\n      this.$emit('componentMountAfter',element,this);\n    },\n    searchUrl: function(element) {\n      for (let i = 0; i < this.tableOption.actions.length; i++) {\n        let actionItem = this.tableOption.actions[i];\n        if (actionItem.key == element.id) {\n          return actionItem;\n        }\n      }\n    },\n    // 动态搜索回调\n    search: function(params) {\n      console.log(params);\n      this.refreshTable(params);\n    },\n    // 新建 & 编辑表单记录完成后的回调事件\n    editCallback: function(type, params) {\n      // type = add   type = edit\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 刷新表单\n    refreshTable: function(params) {\n      // this.$refs.table.tableOption.url =\n      // config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url;\n      // this.$refs.table.tableOption.url = this.$refs.table.tableOption.url;\n      this.$refs.table.tableOption.params = params;\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 显示新建 & 编辑表单记录弹框\n    showAddRecordModal: function() {\n      let _ = this;\n      _.isEdit = true;\n      _.$nextTick(() => {\n        _.layerId = layer.open({\n          type: 1,\n          title: _.seleTableObj ? \"编辑记录\" : \"添加记录\",\n          maxmin: false,\n          area: [\"70%\", \"70%\"],\n          content: $(\"#pop\"),\n          end: function() {\n            _.isEdit = false;\n            _.seleTableObj = {};\n          }\n        });\n      });\n    }\n  },\n\n  components: { vTable, vSearch, vEditTable, vButtons }\n};\n",{"version":3,"sources":["BasePage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"BasePage.vue","sourceRoot":"src/views/BasePage","sourcesContent":["<template>\n  <div>\n    <div class=\"box box-default\">\n      <div class=\"box-body box-body-resizer\">\n        <form class=\"form-inline\" id=\"search-query\" style=\"display: inline-block;\n    width: 100%;\">\n          <div class=\"search-bar\" style=\"float:left;width:99%;position: relative;\">\n            <vSearch ref=\"searchModule\"\n              v-bind:dynamicControls=\"searchOptions.search_controls\"\n              v-bind:exportOptions=\"exportOptions\"\n              v-bind:searchOptions=\"searchOptions.searchOptions\"\n              v-bind:seleFunc=\"searchOptions.seleFunc\"\n              @callback=\"search\"\n              style=\"float:left\"\n            ></vSearch>\n            <br>\n          </div>\n        </form>\n\n        <div v-if=\"buttonOptions.length\" style=\"position: relative;height: 60px;\">\n          <vButtons :buttonOptions=\"buttonOptions\"></vButtons>\n        </div>\n        <vEditTable\n          v-if=\"isEdit\"\n          id=\"pop\"\n          ref=\"editModule\"\n          :dynamicEdits=\"editOptions.dynamicEdits\"\n          :seleTableObj=\"seleTableObj\"\n          @editCallback=\"editCallback\"\n          @componentMountBefore=\"componentMountBefore\" @componentMountAfter=\"componentMountAfter\"\n        ></vEditTable>\n\n        <vTable ref=\"table\" :option=\"tableOption\" @rowBlock=\"rowClick\"></vTable>\n        <div id=\"downloaddiv\" style=\"opaticy: 0\" ></div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport vTable from \"@c/tables/table\";\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\nimport vEditTable from \"@c/edit_table\";\nimport vButtons from \"@c/buttons\";\n\nimport moment from \"moment\";\nimport config from \"@/config/index\";\nimport { pageTool } from \"@/js/util.js\";\n\nexport default {\n  data() {\n    var _ = this;\n    return {\n      isEdit: false,\n      seleTableObj: {} // 选中的表单行数据\n    };\n  },\n  // props: [\"searchOptions\", \"buttonOptions\", \"editOptions\", \"tableOption\"],\n  props: {\n    searchOptions: {\n      type: Object,\n      default: () => {}\n    },\n    buttonOptions: {\n      type: Array,\n      default: () => []\n    },\n    editOptions: {\n      type: Object,\n      default: () => {}\n    },\n    tableOption: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  beforeMount() {\n    let _ = this;\n    !$.isEmptyObject(this.buttonOptions) &&\n      this.buttonOptions.map(item => {\n        if (item.key == \"add\") {\n          item.method = function() {\n            _.showAddRecordModal();\n          };\n        }\n      });\n    this.handleText();\n  },\n\n  computed: {\n    exportOptions: function() {\n      return {\n        id: this.tableOption.tableId,\n        name: this.tableOption.tableName,\n        url: this.searchOptions.exportUrl\n      };\n    }\n  },\n  mounted: function() {},\n  methods: {\n    // 如果给列设置宽度，超出部分文字隐藏显示\n    handleText: function() {\n      this.tableOption.columns.map(item => {\n        if (\"width\" in item) {\n          item.cellStyle = function(value, row, index) {\n            // 设置超过行宽以省略号显示\n            return {\n              css: {\n                overflow: \"hidden\",\n                \"text-overflow\": \"ellipsis\",\n                \"white-space\": \"nowrap\",\n                display: \"inline-block\"\n              }\n            };\n          };\n          item.formatter = function(value, row, index) {\n            var span = document.createElement(\"span\");\n            span.setAttribute(\"title\", value);\n            span.innerHTML = value;\n            return span.outerHTML;\n          };\n        }\n      });\n    },\n    rowClick: function(rowItem, element) {\n      let _ = this;\n      // debugger;\n      let currentAction = _.searchUrl(element);\n      if (!currentAction.url) {\n        _.$emit(\"rowBlock\", rowItem, element, _);\n        return;\n      }\n\n      let param = {};\n      param[_.tableOption.uniqueId] = rowItem[_.tableOption.uniqueId];\n      $.extend(param, currentAction.params);\n\n      currentAction.url(param).then(res => {\n        // debugger;\n        switch (element.id) {\n          case \"tableEdit\":\n            {\n              _.seleTableObj = res.result;\n              _.showAddRecordModal();\n            }\n            break;\n          // case \"tablePause\":\n          //   {\n          //     _.$refs.table.operation(\"refresh\");\n          //   }\n          //   break;\n          case \"tableDownload\":\n            {\n              // location.href = res.result.uploadUrl;\n              // window.open(res.result.uploadUrl);\n              var html = '<a id=\"download-file\" href=\"data:text/xml;charset=utf-8,' + encodeURIComponent(res.result.uploadUrl) + '\" download=\"99\">下载</a>';\n              // var html = '<a id=\"download-file\" href=' + res.result.uploadUrl + ' download=\"5cd1e027d74f49a88c70a23a5e7b1550.Xml\">下载</a>';\n              $(\"#downloaddiv\").html(html);\n              $('#download-file')[0].click();\n\n            }\n            break;\n          default:\n            {\n              _.$emit(\"rowBlock\", rowItem, element, _);\n            }\n            break;\n        }\n      });\n    },\n    componentMountBefore: function(element) {\n      this.$emit('componentMountBefore',element,this);\n    },\n    componentMountAfter: function(element) {\n      // debugger;\n      this.$emit('componentMountAfter',element,this);\n    },\n    searchUrl: function(element) {\n      for (let i = 0; i < this.tableOption.actions.length; i++) {\n        let actionItem = this.tableOption.actions[i];\n        if (actionItem.key == element.id) {\n          return actionItem;\n        }\n      }\n    },\n    // 动态搜索回调\n    search: function(params) {\n      console.log(params);\n      this.refreshTable(params);\n    },\n    // 新建 & 编辑表单记录完成后的回调事件\n    editCallback: function(type, params) {\n      // type = add   type = edit\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 刷新表单\n    refreshTable: function(params) {\n      // this.$refs.table.tableOption.url =\n      // config.pgyerApiUrl + ShellApi.GetAppInfoList.options.url;\n      // this.$refs.table.tableOption.url = this.$refs.table.tableOption.url;\n      this.$refs.table.tableOption.params = params;\n      this.$refs.table.operation(\"refresh\");\n    },\n    // 显示新建 & 编辑表单记录弹框\n    showAddRecordModal: function() {\n      let _ = this;\n      _.isEdit = true;\n      _.$nextTick(() => {\n        _.layerId = layer.open({\n          type: 1,\n          title: _.seleTableObj ? \"编辑记录\" : \"添加记录\",\n          maxmin: false,\n          area: [\"70%\", \"70%\"],\n          content: $(\"#pop\"),\n          end: function() {\n            _.isEdit = false;\n            _.seleTableObj = {};\n          }\n        });\n      });\n    }\n  },\n\n  components: { vTable, vSearch, vEditTable, vButtons }\n};\n</script>\n<style>\ntable tr td {\n  border: 1px solid #f4f4f4;\n}\n.datetimepicker {\n  z-index: 21212121 !important;\n}\n</style>\n\n"]}]}