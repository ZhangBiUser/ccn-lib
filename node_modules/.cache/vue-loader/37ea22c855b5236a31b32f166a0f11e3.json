{"remainingRequest":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/src/views/CodeModule/PrintFileCode/PrintFileCodeManager.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/src/views/CodeModule/PrintFileCode/PrintFileCodeManager.vue","mtime":1553596738966},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/TFS/客户项目/J/君乐宝/君乐宝乳业学生奶追溯项目/源代码/高定报表/前端代码0405/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport vTable from \"@c/tables/table\";\r\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\r\nimport codeApi from \"../webapi/codeApi\";\r\nimport moment from \"moment\";\r\nimport upload from \"@c/upload\";\r\nimport config from \"@/config/index\";\r\nexport default {\r\n  data() {\r\n    var _ = this;\r\n    return {\r\n      startTime: \"\",\r\n      endTime: \"\",\r\n      uploadUrl: codeApi.PrintFileUpload,\r\n      isEdit: false,\r\n      search_controls: [\r\n        {\r\n          type: \"datetime\",\r\n          title: \"开始时间\",\r\n          key: \"startTime\",\r\n          val: \"\"\r\n        },\r\n        {\r\n          type: \"datetime\",\r\n          title: \"结束时间\",\r\n          key: \"endTime\",\r\n          val: \"\"\r\n        }\r\n      ],\r\n      tableOption: {\r\n        url: config.pgyerApiUrl + codeApi.GetPageAllCodeFilesList.options.url,\r\n        method: codeApi.GetPageAllCodeFilesList.options.method,\r\n        columns: [\r\n          {\r\n            field: \"file_name\",\r\n            title: \"文件名称\",\r\n            align: \"center\"\r\n          },\r\n          { field: \"upload_user\", title: \"上传用户\", align: \"center\" },\r\n          {\r\n            field: \"creationTime\",\r\n            title: \"创建时间\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              console.log(val);\r\n              return moment(val).format(\"YYYY-MM-DD HH:mm\");\r\n            }\r\n          },\r\n          {\r\n            field: \"file_number\",\r\n            title: \"总数量\",\r\n            align: \"center\"\r\n          },\r\n          {\r\n            field: \"finish_number\",\r\n            title: \"成功数量\",\r\n            align: \"center\" \r\n          },\r\n            {\r\n            field: \"finish_number\",\r\n            title: \"失败数量\",\r\n            align: \"center\",\r\n             formatter: function(val, row) {\r\n               return row.file_number-row.finish_number;\r\n             }\r\n          },\r\n          {\r\n            field: \"process_state\",\r\n            title: \"处理状态\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return {\r\n                \"0\": \"未处理\",\r\n                \"1\": \"部分处理\",\r\n                \"2\": \"全部处理\",\r\n                \"3\": \"延迟发货处理\"\r\n              }[val];\r\n            }\r\n          },\r\n          {\r\n            field: \"process_result\",\r\n            title: \"处理结果\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return { \"0\": \"无结果\", \"1\": \"无错误\", \"2\": \"有错误\" }[val];\r\n            }\r\n          },\r\n          {\r\n            field: \"id\",\r\n            title: \"操作\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return (\r\n                '<div clss=\"btn-group\">' +\r\n                '<a class=\"btn btn-info btn-sm\"  iid=\"' +\r\n                val +\r\n                '\">详情</a>' +\r\n                \"</div>\"\r\n              );\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      tableDetailOption: {\r\n        url: config.pgyerApiUrl + codeApi.GetPageAllFileCodesList.options.url,\r\n        method: codeApi.GetPageAllFileCodesList.options.method,\r\n        params: {}, //附带信息\r\n        columns: [\r\n          {\r\n            field: \"code\",\r\n            title: \"数码\",\r\n            align: \"center\"\r\n          },\r\n          {\r\n            field: \"f1\",\r\n            title: \"是否存在\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return val == \"0\"\r\n                ? \"<p >存在<p>\"\r\n                : '<p style=\"color:red\">不存在<p>';\r\n            }\r\n          },\r\n          {\r\n            field: \"f2\",\r\n            title: \"是否重复\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return val == \"0\"\r\n                ? \"<p >不重复<p>\"\r\n                : '<p style=\"color:red\">重复<p>';\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  mounted: function() {\r\n    var _ = this;\r\n    _.$refs.table.tableObj.on(\"click\", \"a\", function() {\r\n      _.editModel($(this).attr(\"iid\"));\r\n    });\r\n    _.init();\r\n  },\r\n  methods: {\r\n    init() {\r\n      codeApi.GetPageAllFileCodesList({}).then(res=>{\r\n        console.log(res);\r\n      });\r\n    },\r\n    uploadCallback: function(res) {\r\n      \r\n      if (res.success) {\r\n        layer.open({\r\n          type: 0,\r\n          title: \"提示\",\r\n          content: \"上传成功\"\r\n        });\r\n      } else {\r\n        var msg=\"\";\r\n        if(res.result&&res.result.count>0){\r\n          msg+=\"上传数码中以下数码异常:\";\r\n          res.result.forEach(function(item){\r\n            msg+='【'+item.code+'】';\r\n          });\r\n        }\r\n        layer.open({\r\n          type: 0,\r\n          title: \"提示\",\r\n          content: msg?msg:res.error.message\r\n        });\r\n      }\r\n      this.$refs.table.operation(\"refresh\");\r\n    },\r\n    search: function(params) {\r\n      this.$refs.table.tableOption.params = {\r\n        createdateStart: params.startTime,\r\n        createdateEnd: params.endTime\r\n      };\r\n      this.$refs.table.operation(\"refresh\");\r\n    },\r\n    editModel: function(val) {\r\n      var _ = this;\r\n      _.isEdit = true;\r\n      _.tableDetailOption.params = { file_id: val };\r\n      setTimeout(function() {\r\n        _.layerId = layer.open({\r\n          type: 1,\r\n          title: \"单据详情\",\r\n          maxmin: false,\r\n          area: [\"70%\", \"70%\"],\r\n          content: $(_.$refs.editFrom),\r\n          success: function() {\r\n            $(_.$refs.editFrom).css(\"display\", \"block\");\r\n          },\r\n          end: function() {\r\n            _.isEdit = false;\r\n          }\r\n        });\r\n      }, 0);\r\n    }\r\n  },\r\n  components: { vTable, vSearch, upload }\r\n};\r\n",{"version":3,"sources":["PrintFileCodeManager.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PrintFileCodeManager.vue","sourceRoot":"src/views/CodeModule/PrintFileCode","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"box box-default\">\r\n      <div class=\"box-body box-body-resizer\">\r\n        <form class=\"form-inline\" id=\"search-query\">\r\n          <div class=\"search-bar\" style=\"height:60px\">\r\n            <vSearch v-bind:dynamicControls=\"search_controls\" @callback=\"search\" style=\"float:left\"></vSearch>\r\n            <upload\r\n              :apiUrl=\"uploadUrl\"\r\n              @callback=\"uploadCallback\"\r\n              style=\"margin-left: 10px;float: right;width: 65%;text-align: right;\"\r\n            ></upload>\r\n          </div>\r\n        </form>\r\n        <vTable ref=\"table\" :option=\"tableOption\"></vTable>\r\n      </div>\r\n    </div>\r\n    <div class=\"container-fluid\" v-if=\"isEdit\" ref=\"editFrom\" style=\"display:none\">\r\n      <div class=\"panel-body\">\r\n        <vTable ref=\"tableDetail\" :option=\"tableDetailOption\"></vTable>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport vTable from \"@c/tables/table\";\r\nimport vSearch from \"@c/dynamicSearch/dynamic_Search\";\r\nimport codeApi from \"../webapi/codeApi\";\r\nimport moment from \"moment\";\r\nimport upload from \"@c/upload\";\r\nimport config from \"@/config/index\";\r\nexport default {\r\n  data() {\r\n    var _ = this;\r\n    return {\r\n      startTime: \"\",\r\n      endTime: \"\",\r\n      uploadUrl: codeApi.PrintFileUpload,\r\n      isEdit: false,\r\n      search_controls: [\r\n        {\r\n          type: \"datetime\",\r\n          title: \"开始时间\",\r\n          key: \"startTime\",\r\n          val: \"\"\r\n        },\r\n        {\r\n          type: \"datetime\",\r\n          title: \"结束时间\",\r\n          key: \"endTime\",\r\n          val: \"\"\r\n        }\r\n      ],\r\n      tableOption: {\r\n        url: config.pgyerApiUrl + codeApi.GetPageAllCodeFilesList.options.url,\r\n        method: codeApi.GetPageAllCodeFilesList.options.method,\r\n        columns: [\r\n          {\r\n            field: \"file_name\",\r\n            title: \"文件名称\",\r\n            align: \"center\"\r\n          },\r\n          { field: \"upload_user\", title: \"上传用户\", align: \"center\" },\r\n          {\r\n            field: \"creationTime\",\r\n            title: \"创建时间\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              console.log(val);\r\n              return moment(val).format(\"YYYY-MM-DD HH:mm\");\r\n            }\r\n          },\r\n          {\r\n            field: \"file_number\",\r\n            title: \"总数量\",\r\n            align: \"center\"\r\n          },\r\n          {\r\n            field: \"finish_number\",\r\n            title: \"成功数量\",\r\n            align: \"center\" \r\n          },\r\n            {\r\n            field: \"finish_number\",\r\n            title: \"失败数量\",\r\n            align: \"center\",\r\n             formatter: function(val, row) {\r\n               return row.file_number-row.finish_number;\r\n             }\r\n          },\r\n          {\r\n            field: \"process_state\",\r\n            title: \"处理状态\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return {\r\n                \"0\": \"未处理\",\r\n                \"1\": \"部分处理\",\r\n                \"2\": \"全部处理\",\r\n                \"3\": \"延迟发货处理\"\r\n              }[val];\r\n            }\r\n          },\r\n          {\r\n            field: \"process_result\",\r\n            title: \"处理结果\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return { \"0\": \"无结果\", \"1\": \"无错误\", \"2\": \"有错误\" }[val];\r\n            }\r\n          },\r\n          {\r\n            field: \"id\",\r\n            title: \"操作\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return (\r\n                '<div clss=\"btn-group\">' +\r\n                '<a class=\"btn btn-info btn-sm\"  iid=\"' +\r\n                val +\r\n                '\">详情</a>' +\r\n                \"</div>\"\r\n              );\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      tableDetailOption: {\r\n        url: config.pgyerApiUrl + codeApi.GetPageAllFileCodesList.options.url,\r\n        method: codeApi.GetPageAllFileCodesList.options.method,\r\n        params: {}, //附带信息\r\n        columns: [\r\n          {\r\n            field: \"code\",\r\n            title: \"数码\",\r\n            align: \"center\"\r\n          },\r\n          {\r\n            field: \"f1\",\r\n            title: \"是否存在\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return val == \"0\"\r\n                ? \"<p >存在<p>\"\r\n                : '<p style=\"color:red\">不存在<p>';\r\n            }\r\n          },\r\n          {\r\n            field: \"f2\",\r\n            title: \"是否重复\",\r\n            align: \"center\",\r\n            formatter: function(val, row) {\r\n              return val == \"0\"\r\n                ? \"<p >不重复<p>\"\r\n                : '<p style=\"color:red\">重复<p>';\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  mounted: function() {\r\n    var _ = this;\r\n    _.$refs.table.tableObj.on(\"click\", \"a\", function() {\r\n      _.editModel($(this).attr(\"iid\"));\r\n    });\r\n    _.init();\r\n  },\r\n  methods: {\r\n    init() {\r\n      codeApi.GetPageAllFileCodesList({}).then(res=>{\r\n        console.log(res);\r\n      });\r\n    },\r\n    uploadCallback: function(res) {\r\n      \r\n      if (res.success) {\r\n        layer.open({\r\n          type: 0,\r\n          title: \"提示\",\r\n          content: \"上传成功\"\r\n        });\r\n      } else {\r\n        var msg=\"\";\r\n        if(res.result&&res.result.count>0){\r\n          msg+=\"上传数码中以下数码异常:\";\r\n          res.result.forEach(function(item){\r\n            msg+='【'+item.code+'】';\r\n          });\r\n        }\r\n        layer.open({\r\n          type: 0,\r\n          title: \"提示\",\r\n          content: msg?msg:res.error.message\r\n        });\r\n      }\r\n      this.$refs.table.operation(\"refresh\");\r\n    },\r\n    search: function(params) {\r\n      this.$refs.table.tableOption.params = {\r\n        createdateStart: params.startTime,\r\n        createdateEnd: params.endTime\r\n      };\r\n      this.$refs.table.operation(\"refresh\");\r\n    },\r\n    editModel: function(val) {\r\n      var _ = this;\r\n      _.isEdit = true;\r\n      _.tableDetailOption.params = { file_id: val };\r\n      setTimeout(function() {\r\n        _.layerId = layer.open({\r\n          type: 1,\r\n          title: \"单据详情\",\r\n          maxmin: false,\r\n          area: [\"70%\", \"70%\"],\r\n          content: $(_.$refs.editFrom),\r\n          success: function() {\r\n            $(_.$refs.editFrom).css(\"display\", \"block\");\r\n          },\r\n          end: function() {\r\n            _.isEdit = false;\r\n          }\r\n        });\r\n      }, 0);\r\n    }\r\n  },\r\n  components: { vTable, vSearch, upload }\r\n};\r\n</script>\r\n"]}]}