{"remainingRequest":"/Users/hq_failmy/Desktop/文件上传管理/node_modules/babel-loader/lib/index.js!/Users/hq_failmy/Desktop/文件上传管理/src/js/http.js","dependencies":[{"path":"/Users/hq_failmy/Desktop/文件上传管理/src/js/http.js","mtime":1553140248000},{"path":"/Users/hq_failmy/Desktop/文件上传管理/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_failmy/Desktop/文件上传管理/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import axios from 'axios';\nimport config from '../config';\nimport { Cookie } from '../js/util';\n\nvar debounce = require('lodash/debounce');\n\nvar throttle = require('lodash/throttle');\n\nvar loadingCount = 0;\naxios.defaults.headers.common['Authorization'] = Cookie.getCookie('UACToken') + '|||' + Cookie.getCookie('FactoryId');\n$.ajaxSetup({\n  headers: {\n    // 默认添加请求头  \n    \"Authorization\": Cookie.getCookie('UACToken') + '|||' + Cookie.getCookie('FactoryId')\n  }\n});\nvar _loading = {\n  start: function start() {\n    var throttled = throttle(function () {\n      if (config.isShowLoading) {\n        vue.$store.commit(\"switch_Loading\", true);\n      }\n    }, 1000);\n    throttled();\n    loadingCount++;\n  },\n  stop: function stop() {\n    loadingCount--;\n    var debounced = debounce(function () {\n      if (loadingCount === 0) {\n        config.isShowLoading = true;\n        vue.$store.commit(\"switch_Loading\", false);\n      }\n    }, 250);\n    debounced();\n  }\n};\n\nfunction createInstance() {\n  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    timeout: 30000\n  };\n  var instance = axios.create(config); // 添加请求拦截器\n\n  instance.interceptors.request.use(function (config) {\n    _loading.start();\n\n    return config;\n  }, function (error) {\n    _loading.stop();\n\n    return Promise.reject(error);\n  }); // 添加响应拦截器\n\n  instance.interceptors.response.use(function (response) {\n    _loading.stop();\n\n    return response;\n  }, function (error) {\n    _loading.stop();\n\n    return Promise.reject(error);\n  });\n  return instance;\n}\n\nvar http = createInstance();\n\nhttp.create = function create() {\n  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return createInstance(config);\n};\n\nexport default http;",{"version":3,"sources":["/Users/hq_failmy/Desktop/文件上传管理/src/js/http.js"],"names":["axios","config","Cookie","debounce","require","throttle","loadingCount","defaults","headers","common","getCookie","$","ajaxSetup","_loading","start","throttled","isShowLoading","vue","$store","commit","stop","debounced","createInstance","timeout","instance","create","interceptors","request","use","error","Promise","reject","response","http"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,MAAT,QAAuB,YAAvB;;AACA,IAAMC,QAAQ,GAAGC,OAAO,CAAC,iBAAD,CAAxB;;AACA,IAAMC,QAAQ,GAAGD,OAAO,CAAC,iBAAD,CAAxB;;AAEA,IAAIE,YAAY,GAAG,CAAnB;AACAN,KAAK,CAACO,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiDP,MAAM,CAACQ,SAAP,CAAiB,UAAjB,IAA6B,KAA7B,GAAmCR,MAAM,CAACQ,SAAP,CAAiB,WAAjB,CAApF;AACAC,CAAC,CAACC,SAAF,CAAY;AACRJ,EAAAA,OAAO,EAAE;AAAE;AACP,qBAAiBN,MAAM,CAACQ,SAAP,CAAiB,UAAjB,IAA6B,KAA7B,GAAmCR,MAAM,CAACQ,SAAP,CAAiB,WAAjB;AAD/C;AADD,CAAZ;AAMA,IAAMG,QAAQ,GAAG;AACbC,EAAAA,KADa,mBACL;AACJ,QAAMC,SAAS,GAAGV,QAAQ,CAAC,YAAY;AACnC,UAAIJ,MAAM,CAACe,aAAX,EAAyB;AACrBC,QAAAA,GAAG,CAACC,MAAJ,CAAWC,MAAX,CAAkB,gBAAlB,EAAoC,IAApC;AACH;AAEJ,KALyB,EAKvB,IALuB,CAA1B;AAMAJ,IAAAA,SAAS;AACTT,IAAAA,YAAY;AACf,GAVY;AAWbc,EAAAA,IAXa,kBAWN;AACHd,IAAAA,YAAY;AACZ,QAAMe,SAAS,GAAGlB,QAAQ,CAAC,YAAY;AACnC,UAAIG,YAAY,KAAK,CAArB,EAAwB;AACpBL,QAAAA,MAAM,CAACe,aAAP,GAAuB,IAAvB;AACAC,QAAAA,GAAG,CAACC,MAAJ,CAAWC,MAAX,CAAkB,gBAAlB,EAAoC,KAApC;AACH;AACJ,KALyB,EAKvB,GALuB,CAA1B;AAMAE,IAAAA,SAAS;AACZ;AApBY,CAAjB;;AAuBA,SAASC,cAAT,GAAqD;AAAA,MAA7BrB,MAA6B,uEAApB;AAAEsB,IAAAA,OAAO,EAAE;AAAX,GAAoB;AACjD,MAAMC,QAAQ,GAAGxB,KAAK,CAACyB,MAAN,CAAaxB,MAAb,CAAjB,CADiD,CAEjD;;AACAuB,EAAAA,QAAQ,CAACE,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAAkC,UAAA3B,MAAM,EAAI;AACxCY,IAAAA,QAAQ,CAACC,KAAT;;AACA,WAAOb,MAAP;AACH,GAHD,EAGG,UAAA4B,KAAK,EAAI;AACRhB,IAAAA,QAAQ,CAACO,IAAT;;AACA,WAAOU,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,GAND,EAHiD,CAWjD;;AACAL,EAAAA,QAAQ,CAACE,YAAT,CAAsBM,QAAtB,CAA+BJ,GAA/B,CAAmC,UAAAI,QAAQ,EAAI;AAC3CnB,IAAAA,QAAQ,CAACO,IAAT;;AACA,WAAOY,QAAP;AACH,GAHD,EAGG,UAAAH,KAAK,EAAI;AACRhB,IAAAA,QAAQ,CAACO,IAAT;;AACA,WAAOU,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH,GAND;AAQA,SAAOL,QAAP;AACH;;AAED,IAAMS,IAAI,GAAGX,cAAc,EAA3B;;AAEAW,IAAI,CAACR,MAAL,GAAc,SAASA,MAAT,GAA6B;AAAA,MAAbxB,MAAa,uEAAJ,EAAI;AACvC,SAAOqB,cAAc,CAACrB,MAAD,CAArB;AACH,CAFD;;AAIA,eAAegC,IAAf","sourcesContent":["import axios from 'axios'\r\nimport config from '../config'\r\nimport { Cookie } from '../js/util'\r\nconst debounce = require('lodash/debounce');\r\nconst throttle = require('lodash/throttle');\r\n\r\nlet loadingCount = 0;\r\naxios.defaults.headers.common['Authorization'] = Cookie.getCookie('UACToken')+'|||'+Cookie.getCookie('FactoryId');\r\n$.ajaxSetup({\r\n    headers: { // 默认添加请求头  \r\n        \"Authorization\": Cookie.getCookie('UACToken')+'|||'+Cookie.getCookie('FactoryId')\r\n    }\r\n});\r\n \r\nconst _loading = {\r\n    start() {\r\n        const throttled = throttle(function () {\r\n            if (config.isShowLoading){\r\n                vue.$store.commit(\"switch_Loading\", true);\r\n            }\r\n          \r\n        }, 1000);\r\n        throttled();\r\n        loadingCount++;\r\n    },\r\n    stop() {\r\n        loadingCount--;\r\n        const debounced = debounce(function () {\r\n            if (loadingCount === 0) {\r\n                config.isShowLoading = true;\r\n                vue.$store.commit(\"switch_Loading\", false);\r\n            }\r\n        }, 250);\r\n        debounced();\r\n    }\r\n};\r\n\r\nfunction createInstance(config = { timeout: 30000 }) {\r\n    const instance = axios.create(config);\r\n    // 添加请求拦截器\r\n    instance.interceptors.request.use(config => {\r\n        _loading.start();\r\n        return config;\r\n    }, error => {\r\n        _loading.stop();\r\n        return Promise.reject(error);\r\n    });\r\n\r\n    // 添加响应拦截器\r\n    instance.interceptors.response.use(response => {\r\n        _loading.stop();\r\n        return response;\r\n    }, error => {\r\n        _loading.stop();\r\n        return Promise.reject(error);\r\n    });\r\n\r\n    return instance;\r\n}\r\n\r\nconst http = createInstance();\r\n\r\nhttp.create = function create(config = {}) {\r\n    return createInstance(config);\r\n};\r\n\r\nexport default http"]}]}